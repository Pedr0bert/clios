// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
// â•‘                     CLIOS SHELL - PLUGIN DE UTILIDADES                      â•‘
// â•‘                            utils.rhai v1.0.0                                â•‘
// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// ============================================================================
// FUNÃ‡Ã•ES DE TEXTO
// ============================================================================

/// Converte texto para maiÃºsculas
fn upper(text) {
    text.to_upper()
}

/// Converte texto para minÃºsculas
fn lower(text) {
    text.to_lower()
}

/// Capitaliza primeira letra de cada palavra
fn capitalize(text) {
    let words = text.split(" ");
    let result = [];
    for word in words {
        if word.len() > 0 {
            let first = word.sub_string(0, 1).to_upper();
            let rest = word.sub_string(1).to_lower();
            result.push(first + rest);
        }
    }
    result.join(" ")
}

/// Repete um texto N vezes
fn repeat_text(text, n) {
    let result = "";
    for i in 0..n {
        result += text;
    }
    result
}

/// Remove espaÃ§os extras de um texto
fn trim_all(text) {
    text.trim()
}

// ============================================================================
// FUNÃ‡Ã•ES MATEMÃTICAS
// ============================================================================

/// Calcula a soma de nÃºmeros
fn sum(numbers) {
    let total = 0;
    for n in numbers {
        total += n;
    }
    total
}

/// Calcula a mÃ©dia de nÃºmeros
fn avg(numbers) {
    if numbers.len() == 0 { return 0; }
    sum(numbers) / numbers.len()
}

/// Encontra o valor mÃ¡ximo
fn max(numbers) {
    if numbers.len() == 0 { return 0; }
    let m = numbers[0];
    for n in numbers {
        if n > m { m = n; }
    }
    m
}

/// Encontra o valor mÃ­nimo
fn min(numbers) {
    if numbers.len() == 0 { return 0; }
    let m = numbers[0];
    for n in numbers {
        if n < m { m = n; }
    }
    m
}

/// Calcula fatorial
fn factorial(n) {
    if n <= 1 { return 1; }
    n * factorial(n - 1)
}

/// Calcula potÃªncia
fn power(base, exp) {
    let result = 1;
    for i in 0..exp {
        result *= base;
    }
    result
}

// ============================================================================
// FUNÃ‡Ã•ES DE ARRAY
// ============================================================================

/// Inverte um array
fn reverse(arr) {
    let result = [];
    let i = arr.len() - 1;
    while i >= 0 {
        result.push(arr[i]);
        i -= 1;
    }
    result
}

/// Remove duplicatas de um array
fn unique(arr) {
    let result = [];
    for item in arr {
        let found = false;
        for existing in result {
            if existing == item {
                found = true;
                break;
            }
        }
        if !found {
            result.push(item);
        }
    }
    result
}

/// Conta ocorrÃªncias de um item
fn count(arr, item) {
    let c = 0;
    for i in arr {
        if i == item { c += 1; }
    }
    c
}

// ============================================================================
// FUNÃ‡Ã•ES DE DATA/HORA (helpers)
// ============================================================================

/// Retorna saudaÃ§Ã£o baseada na hora
fn greeting() {
    let hour = timestamp() / 3600 % 24;
    if hour < 12 {
        "Bom dia! â˜€ï¸"
    } else if hour < 18 {
        "Boa tarde! ðŸŒ¤ï¸"
    } else {
        "Boa noite! ðŸŒ™"
    }
}

// ============================================================================
// FUNÃ‡Ã•ES DE VALIDAÃ‡ÃƒO
// ============================================================================

/// Verifica se Ã© um nÃºmero
fn is_number(val) {
    type_of(val) == "i64" || type_of(val) == "f64"
}

/// Verifica se Ã© uma string
fn is_string(val) {
    type_of(val) == "string"
}

/// Verifica se array estÃ¡ vazio
fn is_empty(arr) {
    arr.len() == 0
}

// ============================================================================
// FUNÃ‡Ã•ES DE FORMATAÃ‡ÃƒO
// ============================================================================

/// Formata nÃºmero com separador de milhares
fn format_number(n) {
    let s = n.to_string();
    let result = "";
    let count = 0;
    let i = s.len() - 1;
    while i >= 0 {
        if count > 0 && count % 3 == 0 {
            result = "." + result;
        }
        result = s.sub_string(i, 1) + result;
        count += 1;
        i -= 1;
    }
    result
}

/// Formata bytes para unidade legÃ­vel
fn format_bytes(bytes) {
    let units = ["B", "KB", "MB", "GB", "TB"];
    let size = bytes;
    let unit_idx = 0;
    while size >= 1024 && unit_idx < 4 {
        size = size / 1024;
        unit_idx += 1;
    }
    size.to_string() + " " + units[unit_idx]
}

// ============================================================================
// MENSAGEM DE CARREGAMENTO (desativada para output limpo)
// ============================================================================

// print("   Plugin utils.rhai carregado");
